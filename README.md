# Bookstore AI Chatbot 📚

Một chatbot AI thông minh được xây dựng bằng Streamlit và Google Gemini, giúp người dùng dễ dàng tra cứu thông tin sách và đặt hàng trực tiếp thông qua giao diện trò chuyện tự nhiên.

🚀 Link Dùng Thử Trực Tiếp: [Bookstore Chatbot Demo](https://bookstore-chatbot-7ouvbm8cm7pzrdbgejc5ee.streamlit.app/)


## Features
- **Search Books**: Users can search for books by title or author, retrieving details such as title, author, price, stock, and category.
- **Place Orders**: Users can create orders by providing customer name, phone number, address, book title, and quantity.
- **Interactive UI**: Built with Streamlit for a user-friendly web interface.
- **Function Calling**: Integrates Google Gemini API's function calling to handle book searches and order creation dynamically.
- **SQLite Database**: Stores book inventory and order details.

## Tech Stack
- Language: Python
- AI Model: Google Gemini 1.5 Flash
- Framework: Streamlit
- Database: SQLite
- Core Technique: Function Calling / Tool Use

## Approach & Design
This project leverages the powerful Function Calling capability of the Gemini model to create a reliable and intelligent chatbot.

System Flow:
- User Input: The user sends a message through the Streamlit interface.
- LLM Analysis: The Gemini model receives the user's message and the list of available tools (search_book, create_order).
- Tool Selection: The model determines whether the user's intent is to search for a book or create an order. If so, it identifies the correct function to call and extracts the necessary arguments (e.g., book title, customer name).
- Function Execution: The Python backend executes the chosen function (db_handler.py), which interacts with the SQLite database.
- Response Generation: The result from the function (e.g., book data or order confirmation) is sent back to the Gemini model.
- Final Answer: The model synthesizes the function's result into a natural, human-friendly response to be displayed to the user.

This tool-based approach is superior to simple text generation as it grounds the chatbot's responses in real data from the database, ensuring accuracy and reliability.

## Prerequisites
- Python 3.8+
- A Google API key for Gemini API (set up at [Google AI Studio](https://aistudio.google.com/)).
- Git installed for version control.
- A GitHub account for hosting the repository.

## Installation
1. **Clone the repository**:
   ```bash
   git clone https://github.com/tductam/bookstore-chatbot.git
   cd bookstore-chatbot
   ```

2. **Create and activate a virtual environment**:
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # On Windows: .venv\Scripts\activate
   ```

3. **Install dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Set up the Google API key**:
   - Create a `.streamlit` directory and a `secrets.toml` file:
     ```bash
     mkdir .streamlit
     echo "GOOGLE_API_KEY = \"your-api-key-here\"" > .streamlit/secrets.toml
     ```
   - Replace `your-api-key-here` with your actual key.

5. **Initialize the database**:
   ```bash
   python init_db.py
   ```
   This creates a `bookstore.db` file with sample book data and an orders table.

## Usage
1. **Run the application locally**:
   ```bash
   streamlit run app.py
   ```
   - Open your browser and go to `http://localhost:8501` to interact with the chatbot.
   - Example inputs:
     - "Tìm sách Đắc Nhân Tâm" → Returns book details.
     - "Mua 1 cuốn Nhà Giả Kim, tên A, sdt 0123456789, địa chỉ Hà Nội" → Creates an order.

2. **Expected outputs**:
   - Search: "Sách: Đắc Nhân Tâm, Tác giả: Dale Carnegie, Giá: 120000.0 VND, Tồn kho: 50, Thể loại: Kỹ năng sống"
   - Order: "Đã tạo đơn hàng thành công với mã #X cho sách 'Nhà Giả Kim'. Cảm ơn bạn!"

## Deployment
To deploy the application on Streamlit Cloud:
1. Push the code to a GitHub repository.
2. Log in to [Streamlit Cloud](https://streamlit.io/cloud).
3. Create a new app, select your GitHub repository, and specify `app.py` as the main file.
4. Add `GOOGLE_API_KEY` to the app's Secrets in Streamlit Cloud:
   - Go to the app's settings, add a secret with key `GOOGLE_API_KEY` and your API key as the value.
5. Deploy the app and access it via the provided URL.

## Project Structure
```
bookstore-chatbot/
├── .streamlit/
│   └── secrets.toml      # Stores Google API key (not tracked by Git)
├── .gitignore            # Ignores database, virtual env, and cache files
├── app.py                # Main Streamlit app
├── chatbot_gemini.py     # Chatbot logic with Gemini API
├── db_handler.py         # Database operations (search_book, create_order)
├── init_db.py            # Initializes SQLite database
├── requirements.txt      # Project dependencies
└── bookstore.db          # SQLite database (generated by init_db.py, not tracked by Git)
```

## Development Notes
- The chatbot uses function calling to map user inputs to `search_book` and `create_order` functions.
- History is limited to the last 10 messages to optimize performance.
- Quantity inputs are validated to ensure positive integers.
- Error handling distinguishes between API, database, and general errors.

## Troubleshooting
- **API errors**: Ensure `GOOGLE_API_KEY` is valid and correctly set in `.streamlit/secrets.toml`.
- **Database errors**: Run `python init_db.py` to recreate `bookstore.db`.
- **Unexpected responses**: Check console logs for `History`, `Function call`, and `Function response` to debug.

## Contributing
1. Fork the repository.
2. Create a feature branch: `git checkout -b feature-name`.
3. Commit changes: `git commit -m "Add feature"`.
4. Push to the branch: `git push origin feature-name`.
5. Open a pull request.

## License
MIT License